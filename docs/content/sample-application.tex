%----------------------------------------------------------------------------
\chapter{Sample application}
%----------------------------------------------------------------------------

\begin{itemize}
	\item Why need a case-study?
	\item Introduce the general problem it solves (naive implementation of Fibonacci)
	\item introduce the general master-job-worker pattern it is based upon

\end{itemize}

This chapter presents the design and implementation of the sample application which will act as a case-study the showcase the features of the test framework. 


%----------------------------------------------------------------------------
\section{Design}
%----------------------------------------------------------------------------

%----------------------------------------------------------------------------
\subsection{Requirements}
%----------------------------------------------------------------------------

\begin{itemize}
	\item objectives
	\begin{itemize}
		\item microservices architecture
		\item containerization - facilitates easy deployment and scalability
		\item have a system with different components bases on state-fullness (stateful, stateless, )
		\item have component(s) that can be scaled based on some application specific workload requirements (e.g. increased load on the system, fault tolerant redundancy) - stateless components can be scaled more easily
		\item observable and collectible application specific metrics
	\end{itemize}
\end{itemize}

%----------------------------------------------------------------------------
\subsection{Architecture}
%----------------------------------------------------------------------------

TODO: architecture diagram

\begin{itemize}
	\item master-worker architecture
	\item REST API interfaces
	\item use-case
	\begin{itemize}
		\item submitting computation jobs
		\item distributing jobs among worker nodes
		\item persisting job results
		\item querying job results
	\end{itemize}
	
\end{itemize}


%----------------------------------------------------------------------------
\subsection{Components}
%----------------------------------------------------------------------------

In the following sections I present each component and their responsibilities.

%----------------------------------------------------------------------------
\subsubsection{Backend}
%----------------------------------------------------------------------------

\begin{itemize}
	\item provides a REST API interface for submitting new jobs and querying their result
	\item forward submitted jobs to worker nodes
	\item stores the result of finished jobs in a database
	\item exposes a metrics endpoint for external monitoring solutions
	\item exposes health endpoint that can be consumed to verify that the system works in a functionally correct way
\end{itemize}

responsibilites + API + health endpoint

%----------------------------------------------------------------------------
\subsubsection{Worker}
%----------------------------------------------------------------------------

\begin{itemize}
	\item provides a REST API interface to accept jobs from the backend to execute
	\item exposes a metrics endpoint for external monitoring solutions
	\item exposes health endpoint
\end{itemize}

responsibilites + API + health endpoint

%----------------------------------------------------------------------------
\subsubsection{Message Queue}
%----------------------------------------------------------------------------

\begin{itemize}
	\item connects the backend with the worker nodes
	\item as the number of worker nodes is dynamic, it would be not feasible for the backend to try to keep record of all the running workers
	\item the backend sends the jobs to the workers via this message queue
	\item the the workers also use this to send back the finished jobs (at the moment, we could skip the message queue on the way back, but this way we do not need much modification if there would be more than one backend in order to \eg be able to handle a bigger load)
\end{itemize}

%----------------------------------------------------------------------------
\subsubsection{Database}
%----------------------------------------------------------------------------

\begin{itemize}
	\item stores the jobs with their result 
	\item serves queries made by the backend component
\end{itemize}

%----------------------------------------------------------------------------
\section{Implementation}
%----------------------------------------------------------------------------

\begin{itemize}
	\item Docker
	\item K8s deployment Pod, Depl, Service for each , example for each
\end{itemize}

%----------------------------------------------------------------------------
\subsection{Backend}
%----------------------------------------------------------------------------

\begin{itemize}
	\item Spring Boot Java
	\item introduce Job model
	\item introduce REST API
	\item introduce health check
	\item introduce Message Queue integration
\end{itemize}

%----------------------------------------------------------------------------
\subsection{Worker}
%----------------------------------------------------------------------------

\begin{itemize}
	\item Spring Boot Java
	\item introduce REST API
	\item introduce health check
	\item introduce Message Queue integration
\end{itemize}

%----------------------------------------------------------------------------
\subsection{Message Queue}
%----------------------------------------------------------------------------

\begin{itemize}
	\item configuration? image?
\end{itemize}

%----------------------------------------------------------------------------
\subsection{Database}
%----------------------------------------------------------------------------

\begin{itemize}
	\item configuration? image?
\end{itemize}

















