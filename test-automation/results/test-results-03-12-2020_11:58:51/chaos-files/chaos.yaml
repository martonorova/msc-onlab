# Pod Failure action periodically injects errors to pods.
# And it will cause pod creation failure for a while. 
# In other words, the selected pod will be unavailable in a specified period.

apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: pod-failure-worker
  namespace: chaos-testing
spec:
  action: pod-failure
  mode: one
  value: ""
  # mode: random-max-percent
  # value: "50"
  duration: "30s"
  selector:
    namespaces:
      - kubedepend
    labelSelectors:
      "app": "kubedepend-worker-app"
  scheduler:
    cron: "@every 1m"

# ---

# apiVersion: chaos-mesh.org/v1alpha1
# kind: NetworkChaos
# metadata:
#   name: backend-network-delay
#   namespace: chaos-testing
# spec:
#   action: delay # the specific chaos action to inject
#   mode: one # the mode to run chaos action; supported modes are one/all/fixed/fixed-percent/random-max-percent
#   selector: # pods where to inject chaos actions
#     namespaces:
#       - kubedepend
#     labelSelectors:
#       "app": "kubedepend-backend-app"  # the label of the pod for chaos injection
#   delay:
#     latency: "500ms"
#   duration: "30s" # duration for the injected chaos experiment
#   scheduler: # scheduler rules for the running time of the chaos experiments about pods.
#     cron: "@every 60s"

# ---

# apiVersion: chaos-mesh.org/v1alpha1
# kind: NetworkChaos
# metadata:
#   name: network-partition-backend-to-db
#   namespace: kubedepend
# spec:
#   action: partition
#   mode: one
#   selector:
#     namespace:
#       - kubedepend
#     labelSelectors:
#       "app": "kubedepend-backend-app"
#   direction: both
#   target:
#     selector:
#       namespaces:
#         - kubedepend
#       labelSelectors:
#         "app": "kubedepend-db-app"
#     mode: one
#   duration: "5s"
#   scheduler:
#     cron: "@every 15s"